(this["webpackJsonpcatalog-spa"]=this["webpackJsonpcatalog-spa"]||[]).push([[0],{203:function(e,t,a){e.exports=a(337)},337:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),c=a(35),o=a.n(c),u=a(9),s=a(38),i=a(170),l=a(5),d="USER_REGISTRATION_REQUEST",p="USER_REGISTRATION_SUCCESS",m="USER_REGISTRATION_FAILURE",b="USER_LOGIN_REQUEST",f="USER_LOGIN_SUCCESS",E="USER_LOGIN_FAILURE",g="USER_LOGOUT",O="SET_CURRENT_STATUS",j="SET_ERROR_MESSAGE",h={loginRequest:"Logging in",loginSuccess:"Logged in",loginFailure:"Login attempt failed!",notLoggedIn:"Not logged in",registrationRequest:"Registration",registrationSuccess:"Registration completed",registrationFailure:"Registration failed"},P={isLoggedIn:!1,userType:"",currentStatus:h.notLoggedIn,error:""},v={getProductsRequest:"GET_PRODUCTS_REQUEST",getProductsSuccess:"GET_PRODUCTS_SUCCESS",getProductsFailure:"GET_PRODUCTS_FAILURE",updateProductRequest:"UPDATE_PRODUCT_REQUEST",updateProductSuccess:"UPDATE_PRODUCT_SUCCESS",updateProductFailure:"UPDATE_PRODUCT_FAILURE",getProductPagesNumber:"GET_PRODUCT_PAGES_NUMBER",setProductPagesNumber:"SET_PRODUCT_PAGES_NUMBER",setProductsList:"SET_PRODUCTS_LIST",setProductsPage:"SET_PRODUCTS_PAGE",addProduct:"ADD_PRODUCT",addProductSuccess:"CREATE_PRODUCT_SUCCESS",addProductFailure:"CREATE_PRODUCT_FAILURE",resetProducts:"RESET_PRODUCTS",deleteProduct:"DELETE_PRODUCT",setCurrentAction:"SET_CURRENT_ACTION",setErrorMessage:"SET_ERROR_MESSAGE",setQueryParams:"SET_QUERY_PARAMS",showEditingModal:"SHOW_EDITING_MODAL",closeEditingModal:"CLOSE_EDITING_MODAL",setCurrentProduct:"SET_CURRENT_PRODUCT"},S={items:[],pagesNumber:1,page:1,currentAction:"",error:"",queryParams:{},showEditingModal:!1,currentProduct:null},y=Object(s.c)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case b:return Object(l.a)(Object(l.a)({},e),{},{currentStatus:h.loginRequest,error:""});case f:return Object(l.a)(Object(l.a)({},e),{},{isLoggedIn:!0,userType:t.userType,currentStatus:h.loginSuccess,email:t.email,error:""});case E:return Object(l.a)(Object(l.a)({},e),{},{currentStatus:h.loginFailure,error:t.error});case d:return Object(l.a)(Object(l.a)({},e),{},{currentStatus:h.registrationRequestm,error:""});case p:return Object(l.a)(Object(l.a)({},e),{},{currentStatus:h.registrationSuccess,error:""});case m:return Object(l.a)(Object(l.a)({},e),{},{currentStatus:h.registrationFailure,error:t.error});case j:return Object(l.a)(Object(l.a)({},e),{},{error:t.error});case O:return Object(l.a)(Object(l.a)({},e),{},{currentStatus:h.setCurrentStatus,status:t.status});case g:return P;default:return e}},products:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case v.setProductPagesNumber:return Object(l.a)(Object(l.a)({},e),{},{pagesNumber:t.pagesNumber});case v.setProductsPage:return Object(l.a)(Object(l.a)({},e),{},{page:t.page});case v.setProductsList:return Object(l.a)(Object(l.a)({},e),{},{items:t.items});case v.resetProducts:return S;case v.getProductsRequest:return Object(l.a)(Object(l.a)({},e),{},{currentAction:v.getProductsRequest});case v.getProductsSuccess:return Object(l.a)(Object(l.a)({},e),{},{currentAction:v.getProductsSuccess});case v.getProductsFailure:return Object(l.a)(Object(l.a)({},e),{},{currentAction:v.getProductsFailure});case v.updateProductRequest:return Object(l.a)(Object(l.a)({},e),{},{currentAction:v.updateProductRequest});case v.updateProductSuccess:return Object(l.a)(Object(l.a)({},e),{},{currentAction:v.updateProductSuccess});case v.updateProductFailure:return Object(l.a)(Object(l.a)({},e),{},{currentAction:v.updateProductFailure});case v.setErrorMessage:return Object(l.a)(Object(l.a)({},e),{},{error:t.error});case v.setcurrentAction:return Object(l.a)(Object(l.a)({},e),{},{status:t.currentAction});case v.setQueryParams:return Object(l.a)(Object(l.a)({},e),{},{queryParams:Object(l.a)(Object(l.a)({},e.queryParams),t.queryParams)});case v.showEditingModal:return Object(l.a)(Object(l.a)({},e),{},{showEditingModal:!0});case v.closeEditingModal:return Object(l.a)(Object(l.a)({},e),{},{showEditingModal:!1});case v.setCurrentProduct:return Object(l.a)(Object(l.a)({},e),{},{currentProduct:t.product});default:return e}}}),w=Object(s.e)(y,Object(s.d)(Object(s.a)(i.a),window.__REDUX_DEVTOOLS_EXTENSION__?window.__REDUX_DEVTOOLS_EXTENSION__():function(e){return e})),C=a(48),R=a(15),T=a(350),D=a(358),_=a(11),A=a(357),k=a(347),U=a(352),q=a(362),N=a(21),F=a.n(N),I=a(41),x=function(e){return function(){var t=Object(I.a)(F.a.mark((function t(a){var r,n,c,o,u;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r="https://thelonerover.github.io/catalog-spa/products",e.page&&(r+="/page/".concat(e.page)),e.queryParams){for(c in n=[],e.queryParams)""!==e.queryParams[c]&&n.push("".concat(c,"=").concat(e.queryParams[c]));(n=n.join("&")).length>0&&(r+="/?".concat(n))}return a({type:v.getProductsRequest}),t.prev=4,t.next=7,fetch(r);case 7:return o=t.sent,t.next=10,o.json();case 10:u=t.sent,o.ok?(a(L()),a(J(u.numberOfPages)),a(Q(u.products))):a(M()),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(4),console.error(t.t0);case 17:case"end":return t.stop()}}),t,null,[[4,14]])})));return function(e){return t.apply(this,arguments)}}()},L=function(){return{type:v.getProductsSuccess}},M=function(){return{type:v.getProductsFailure}},G=function(){return{type:v.updateProductSuccess}},B=function(){return{type:v.updateProductFailure}},J=function(e){return{type:v.setProductPagesNumber,pagesNumber:e}},Q=function(e){return{type:v.setProductsList,items:e}},H=function(e){return{type:v.setProductsPage,page:e}},X=function(){return{type:v.addProductSuccess}},z=function(){return{type:v.addProductFailure}},Y=function(){return{type:v.resetProducts}},V=function(e){return{type:v.setQueryParams,queryParams:e}},W=function(){return{type:v.closeEditingModal}},K=a(338),Z=function(e){var t,a,r=Object(u.b)(),c=Object(u.c)((function(e){return e.products})),o=new Date(e.creationDate),s="".concat(o.getDate(),"/").concat(o.getMonth()+1,"/").concat(o.getFullYear());return n.a.createElement(U.a,null,n.a.createElement(U.a.Content,null,n.a.createElement(U.a.Header,{as:"a"},e.name),n.a.createElement(U.a.Meta,null,n.a.createElement("span",{className:"date"},"Created on ",s)),n.a.createElement(U.a.Description,null,e.description),n.a.createElement("span",null,e.price),n.a.createElement(U.a.Extra,null,n.a.createElement(K.a,{basic:!0,floated:"right",color:"red",onClick:(a=e.id,function(){r(function(e){return function(){var t=Object(I.a)(F.a.mark((function t(a){return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a({type:v.deleteProduct}),t.prev=1,t.next=4,fetch("https://thelonerover.github.io/catalog-spa/products/".concat(e),{method:"DELETE"});case 4:t.next=9;break;case 6:t.prev=6,t.t0=t.catch(1),console.log(t.t0);case 9:case"end":return t.stop()}}),t,null,[[1,6]])})));return function(e){return t.apply(this,arguments)}}()}(a)),r(x({page:c.page,queryParams:c.queryParams}))})},"Delete"),n.a.createElement(K.a,{primary:!0,floated:"right",onClick:(t=e,function(){r({type:v.showEditingModal}),r({type:v.setCurrentProduct,product:t})})},"Edit"))))},$=function(){var e=Object(u.b)(),t=Object(u.c)((function(e){return e.products})),a=Object(r.useState)(!0),c=Object(_.a)(a,2),o=c[0],s=c[1];Object(r.useEffect)((function(){return function(){return e(Y())}}),[]),Object(r.useEffect)((function(){e(x({page:t.page,queryParams:t.queryParams}))}),[t.page]),Object(r.useEffect)((function(){switch(t.currentAction){case v.getProductsRequest:s(!0);break;case v.getProductsSuccess:s(!1)}}),[t.currentAction]);return n.a.createElement(D.a,{columns:1,relaxed:!0,padded:"vertically"},n.a.createElement(D.a.Row,null,o&&n.a.createElement(A.a,{active:!0,inverted:!0},n.a.createElement(k.a,{inverted:!0,content:"Loading products"})),n.a.createElement(D.a.Column,null,n.a.createElement(U.a.Group,{divided:!0},t.items.map((function(e){return n.a.createElement(Z,Object.assign({key:e.id},e))}))))),n.a.createElement(D.a.Row,null,n.a.createElement(D.a.Column,null,n.a.createElement(q.a,{defaultActivePage:1,activePage:t.activePage,totalPages:t.pagesNumber,onPageChange:function(t,a){var r=a.activePage;e(H(r))}}))))},ee=a(359),te=a(353),ae=a(351),re=function(e,t){return{type:b,email:e,password:t}},ne=function(e,t){return{type:f,email:e,userType:t}},ce=function(e){return{type:E,error:e}},oe=function(e){return{type:d,email:e.email,password:e.password}},ue=function(){return{type:p}},se=function(e){return{type:m,error:e}},ie=function(e){return{type:j,error:e}},le=function(e){return{type:O,status:e}},de=a(19),pe=a(348),me=a(355),be=function(){var e,t,a=Object(r.useState)({email:"admin@example.com",password:"123"}),c=Object(_.a)(a,2),o=c[0],s=c[1],i={email:!1,password:!1},d=Object(r.useState)(Object(l.a)({},i)),p=Object(_.a)(d,2),m=p[0],b=p[1],f=Object(u.c)((function(e){return e.user})),E=Object(r.useState)({}),g=Object(_.a)(E,2),O=g[0],j=g[1],P=Object(u.b)();Object(r.useEffect)((function(){return function(){S()}}),[]),Object(r.useEffect)((function(){switch(f.currentStatus){case h.loginRequest:j({loading:!0});break;case h.loginSuccess:j({success:!0});break;case h.loginFailure:j({error:!0})}}),[f.currentStatus]);var v=function(e){return function(t){t.preventDefault(),s(Object(l.a)(Object(l.a)({},o),{},Object(de.a)({},e,t.target.value)))}},S=function(){j({}),b(Object(l.a)({},i)),P(ie("")),P(le(""))};return n.a.createElement("div",null,n.a.createElement(ae.a,Object.assign({method:"post",action:"/login"},O,{onSubmit:function(e){e.preventDefault()}}),n.a.createElement(ae.a.Field,(e={type:"email",control:pe.a,label:"E-mail",placeholder:"E-mail",onChange:v("email")},Object(de.a)(e,"label",{icon:"asterisk"}),Object(de.a)(e,"value",o.email),Object(de.a)(e,"error",m.email),e)),n.a.createElement(ae.a.Field,(t={type:"password",control:pe.a,label:"Password",placeholder:"Password",onChange:v("password")},Object(de.a)(t,"label",{icon:"asterisk"}),Object(de.a)(t,"value",o.password),Object(de.a)(t,"error",m.password),t)),n.a.createElement(K.a,{color:"blue",name:"login",onClick:function(e){e.preventDefault(),P(ie("")),j({});var t=Object(l.a)({},i);o.email||(t.email={content:"Please enter a valid email address!",pointing:"below"}),o.password||(t.password={content:"Please enter a valid password!",pointing:"below"}),b(t),o.email&&o.password&&(S(),P(function(e){return function(){var t=Object(I.a)(F.a.mark((function t(a){var r,n,c;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a(re(e)),r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e.email,password:e.password})},t.prev=2,t.next=5,fetch("https://thelonerover.github.io/catalog-spa/login",r);case 5:return n=t.sent,t.next=8,n.json();case 8:c=t.sent,n.ok?a(ne(c.email,c.type)):a(ce(c.error)),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(2),console.error(t.t0);case 15:case"end":return t.stop()}}),t,null,[[2,12]])})));return function(e){return t.apply(this,arguments)}}()}(o)))}},"Log In")),O.error&&n.a.createElement(me.a,Object.assign({compact:!0},O,{header:f.error})))},fe=function(){var e=n.a.useState(!1),t=Object(_.a)(e,2),a=t[0],r=t[1],c=Object(u.c)((function(e){return e.user})),o=Object(u.b)();return c.isLoggedIn?n.a.createElement(ae.a,{mathod:"POST",action:"logout",onSubmit:function(e){e.preventDefault()}},n.a.createElement(K.a,{onClick:function(e){e.preventDefault(),r(!1),o({type:g})}},"Log out")):n.a.createElement(te.a,{size:"mini",onClose:function(){return r(!1)},onOpen:function(){return r(!0)},open:a,trigger:n.a.createElement(K.a,{primary:!0},"Log in")},n.a.createElement(te.a.Header,null,"Log in"),n.a.createElement(te.a.Content,null,n.a.createElement(be,null)))};function Ee(){var e=Object(r.useState)({email:"",password:"",passwordConfirmation:""}),t=Object(_.a)(e,2),a=t[0],c=t[1],o=Object(r.useState)({}),s=Object(_.a)(o,2),i=s[0],d=s[1],p={email:!1,password:!1,passwordConfirmation:!1},m=Object(r.useState)(Object(l.a)({},p)),b=Object(_.a)(m,2),f=b[0],E=b[1],g=Object(u.c)((function(e){return e.user})),O=Object(u.b)();Object(r.useEffect)((function(){return function(){P()}}),[]),Object(r.useEffect)((function(){switch(g.currentStatus){case h.registrationRequest:d({loading:!0});break;case h.registrationFailure:d({error:!0});break;case h.registrationSuccess:d({success:!0})}}),[g.currentStatus]);var j=function(e){return function(t){t.preventDefault(),c(Object(l.a)(Object(l.a)({},a),{},Object(de.a)({},e,t.target.value)))}},P=function(){d({}),E(Object(l.a)({},p)),O(ie("")),O(le(""))};return g.currentStatus!==h.registrationSuccess?n.a.createElement(ae.a,Object.assign({method:"post"},i,{action:"/users",onSubmit:function(e){e.preventDefault()}}),n.a.createElement(ae.a.Field,{type:"email",control:pe.a,label:"E-mail",placeholder:"E-mail",onChange:j("email"),value:a.email,error:f.email}),n.a.createElement(ae.a.Field,{type:"password",control:pe.a,label:"Password",placeholder:"Password",onChange:j("password"),value:a.password,error:f.password}),n.a.createElement(ae.a.Field,{type:"password",control:pe.a,label:"Confirm password",placeholder:"Confirm password",onChange:j("passwordConfirmation"),value:a.passwordConfirmation,error:f.passwordConfirmation}),n.a.createElement(K.a,{color:"blue",name:"register",onClick:function(e){e.preventDefault();var t=Object(l.a)({},p);a.email||(t.email={content:"Please enter a login!",pointing:"below"}),a.password||(t.password={content:"Please enter a password!",pointing:"below"}),a.password!==a.passwordConfirmation&&(t.passwordConfirmation={content:"Passwords do not match!",pointing:"below"}),E(t),a.email&&a.password&&a.passwordConfirmation&&a.password===a.passwordConfirmation?(P(),O(function(e){return function(){var t=Object(I.a)(F.a.mark((function t(a){var r,n,c;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a(oe(e)),r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e.email,password:e.password,type:"C"})},t.prev=2,t.next=5,fetch("https://thelonerover.github.io/catalog-spa/users",r);case 5:return n=t.sent,t.next=8,n.json();case 8:c=t.sent,n.ok?a(ue()):a(se(c.error)),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(2),console.log(t.t0);case 15:case"end":return t.stop()}}),t,null,[[2,12]])})));return function(e){return t.apply(this,arguments)}}()}(a))):d({error:!0})}},"Create an account")):n.a.createElement(me.a,Object.assign({},i,{header:g.currentStatus}))}var ge=function(){var e=n.a.useState(!1),t=Object(_.a)(e,2),a=t[0],r=t[1],c=Object(u.c)((function(e){return e.user}));return n.a.createElement(te.a,{size:"mini",onClose:function(){return r(!1)},onOpen:function(){return r(!0)},open:a,trigger:n.a.createElement(K.a,{basic:!0},"Register")},n.a.createElement(te.a.Header,null,"Register"),n.a.createElement(te.a.Content,null,n.a.createElement(Ee,null)),c.currentStatus===h.registrationSuccess&&n.a.createElement(te.a.Actions,null,n.a.createElement(K.a,{color:"green",onClick:function(){return r(!1)}},"Done!")))},Oe=function(){var e=Object(u.c)((function(e){return e.user}));return n.a.createElement(ee.a,null,n.a.createElement(ee.a.Item,{name:"catalog"},n.a.createElement(C.b,{to:"/"},"Catalog")),"A"===e.userType&&n.a.createElement(ee.a.Item,{name:"admin-panel"},n.a.createElement(C.b,{to:"admin-panel"},"Admin panel")),n.a.createElement(ee.a.Menu,{position:"right"},n.a.createElement(ee.a.Item,{name:"login"},n.a.createElement(fe,null)),!e.isLoggedIn&&n.a.createElement(ee.a.Item,{name:"registration"},n.a.createElement(ge,null))))};function je(){return n.a.createElement(T.a,null,n.a.createElement(Oe,null),n.a.createElement("p",null,"404"))}var he=a(360),Pe=function(){var e=Object(r.useState)({name:"",priceFrom:"",priceTo:""}),t=Object(_.a)(e,2),a=t[0],c=t[1],o=Object(u.c)((function(e){return e.products})),s=Object(u.b)(),i=Object(r.useRef)(!0),d=Object(r.useState)(!0),p=Object(_.a)(d,2),m=p[0],b=p[1];Object(r.useEffect)((function(){return function(){s(V({}))}}),[]),Object(r.useEffect)((function(){i.current?i.current=!1:s(V(a))}),[a]),Object(r.useEffect)((function(){switch(o.currentAction){case v.getProductsRequest:b(!0);break;case v.getProductsSuccess:b(!1)}}),[o.currentAction]);var f=function(e){return function(t){t.preventDefault(),c(Object(l.a)(Object(l.a)({},a),{},Object(de.a)({},e,t.target.value)))}};return n.a.createElement(ae.a,{method:"post",action:"/login",onSubmit:function(e){e.preventDefault()}},n.a.createElement(he.a,{as:"h3",content:"Product filters"}),n.a.createElement(ae.a.Field,{type:"name",control:pe.a,placeholder:"Product name",onChange:f("name"),value:a.name,disabled:m}),n.a.createElement(ae.a.Group,{widths:"equal"},n.a.createElement(ae.a.Field,{fluid:!0,type:"number",control:pe.a,placeholder:"Price from",onChange:f("priceFrom"),value:a.priceFrom,disabled:m}),n.a.createElement(ae.a.Field,{fluid:!0,type:"number",control:pe.a,placeholder:"to",onChange:f("priceTo"),value:a.priceTo,disabled:m})),n.a.createElement(K.a,{type:"submit",secondary:!0,name:"submit",onClick:function(e){e.preventDefault(),s(x({page:o.page,queryParams:o.queryParams}))},loading:m},"Show products"))},ve=function(){var e=Object(r.useState)({type:"",order:!0}),t=Object(_.a)(e,2),a=t[0],c=t[1],o=Object(u.c)((function(e){return e.products})),s=Object(u.b)(),i=Object(r.useRef)(!0);Object(r.useEffect)((function(){return function(){s(V({}))}}),[]),Object(r.useEffect)((function(){i.current||s(V({sort:"".concat(a.type,"-").concat(a.order?"descend":"ascend")}))}),[a]),Object(r.useEffect)((function(){i.current?i.current=!1:s(x({page:o.page,queryParams:o.queryParams}))}),[o.queryParams.sort]);var d=function(e,t){var r=t.name;a.type===r?c(Object(l.a)(Object(l.a)({},a),{},{order:!a.order})):c(Object(l.a)(Object(l.a)({},a),{},{type:r,order:!0}))};return n.a.createElement(ee.a,{text:!0},n.a.createElement(ee.a.Item,{header:!0},"Sort By"),n.a.createElement(ee.a.Item,{name:"name",active:"name"===a.type,onClick:d,content:"Name".concat("name"===a.type?a.order?" \u25bc":" \u25b2":"")}),n.a.createElement(ee.a.Item,{name:"price",active:"price"===a.type,onClick:d,content:"Price".concat("price"===a.type?a.order?" \u25bc":" \u25b2":"")}),n.a.createElement(ee.a.Item,{name:"date",active:"date"===a.type,onClick:d,content:"Creation date".concat("date"===a.type?a.order?" \u25bc":" \u25b2":"")}))},Se=a(349),ye=function(){var e=Object(r.useState)({}),t=Object(_.a)(e,2),a=t[0],c=t[1],o=Object(r.useState)({name:"",description:"",price:0}),s=Object(_.a)(o,2),i=s[0],d=s[1],p={name:!1},m=Object(u.c)((function(e){return e.products})),b=Object(r.useState)(Object(l.a)({},p)),f=Object(_.a)(b,2),E=f[0],g=f[1],O=Object(u.b)();Object(r.useEffect)((function(){return function(){j()}}),[]);var j=function(){c({}),g(Object(l.a)({},p))},h=function(e){return function(t){t.preventDefault(),d(Object(l.a)(Object(l.a)({},i),{},Object(de.a)({},e,t.target.value)))}};return n.a.createElement(ae.a,Object.assign({method:"post",action:"/products"},a,{onSubmit:function(e){e.preventDefault()}}),n.a.createElement(ae.a.Field,{type:"text",control:pe.a,name:"name",label:"Name",placeholder:"Name",onChange:h("name"),value:i.name,error:E.name}),n.a.createElement(ae.a.Field,{control:Se.a,name:"description",label:"Description",placeholder:"Description",onChange:h("description"),value:i.description}),n.a.createElement(ae.a.Field,{type:"number",control:pe.a,name:"price",label:"Price",placeholder:"Price",onChange:h("price"),value:i.price}),n.a.createElement(K.a,{color:"blue",name:"update",onClick:function(e){e.preventDefault(),c({});var t,a=Object(l.a)({},p);i.name||(a.name={content:"Please enter a valid name!",pointing:"below"}),g(a),i.name&&(j(),O((t=i,function(){var e=Object(I.a)(F.a.mark((function e(a){var r;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a({type:v.addProduct}),r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)},e.prev=2,e.next=5,fetch("https://thelonerover.github.io/catalog-spa/products",r);case 5:e.sent.ok?a(X()):a(z()),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}())),O(x({page:m.page,queryParams:m.queryParams})))}},"Add product"),a.error&&n.a.createElement(me.a,Object.assign({compact:!0},a,{header:m.error})))},we=function(e){var t=Object(r.useState)({}),a=Object(_.a)(t,2),c=a[0],o=a[1],s=Object(r.useState)({id:e.id,name:e.name,description:e.description,price:e.price}),i=Object(_.a)(s,2),d=i[0],p=i[1],m={name:!1},b=Object(r.useState)(Object(l.a)({},m)),f=Object(_.a)(b,2),E=f[0],g=f[1],O=Object(u.c)((function(e){return e.products})),j=Object(u.b)();Object(r.useEffect)((function(){return function(){h()}}),[]);var h=function(){o({}),g(Object(l.a)({},m)),j({type:v.setCurrentAction,currentAction:""})},P=function(e){return function(t){t.preventDefault(),p(Object(l.a)(Object(l.a)({},d),{},Object(de.a)({},e,t.target.value)))}};return n.a.createElement(ae.a,Object.assign({method:"post",action:"/products"},c,{onSubmit:function(e){e.preventDefault()}}),n.a.createElement(ae.a.Field,{type:"text",control:pe.a,name:"name",label:"Name",placeholder:"Name",onChange:P("name"),value:d.name,error:E.name}),n.a.createElement(ae.a.Field,{control:Se.a,name:"description",label:"Description",placeholder:"Description",onChange:P("description"),value:d.description}),n.a.createElement(ae.a.Field,{type:"number",control:pe.a,name:"price",label:"Price",placeholder:"Price",onChange:P("price"),value:d.price}),n.a.createElement(K.a,{primary:!0,name:"update",onClick:function(e){e.preventDefault(),o({});var t,a=Object(l.a)({},m);d.name||(a.name={content:"Please enter a valid name!",pointing:"below"}),g(a),d.name&&(j((t=d,function(){var e=Object(I.a)(F.a.mark((function e(a){var r,n;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="https://thelonerover.github.io/catalog-spa/products/".concat(t.id),a({type:v.updateProductRequest}),n={method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object(l.a)({},t))},e.prev=3,e.next=6,fetch(r,n);case 6:e.sent.ok?a(G()):a(B()),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),console.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t){return e.apply(this,arguments)}}())),j(x({page:O.page,queryParams:O.queryParams}))),j(W())}},"Save changes"),n.a.createElement(K.a,{secondary:!0,onClick:function(){j(W())}},"Cancel"))},Ce=function(){var e=Object(u.c)((function(e){return e.products}));return n.a.createElement(te.a,{size:"mini",open:e.showEditingModal},n.a.createElement(te.a.Header,null,"Edit product"),n.a.createElement(te.a.Content,null,n.a.createElement(we,e.currentProduct)))};function Re(){var e=Object(u.c)((function(e){return e.user}));return n.a.createElement(T.a,null,"A"===e.userType?n.a.createElement("div",null,n.a.createElement(Oe,null),n.a.createElement(Ce,null),n.a.createElement(D.a,{divided:"vertically"},n.a.createElement(D.a.Row,{columns:3},n.a.createElement(D.a.Column,{width:4},n.a.createElement(Pe,null)),n.a.createElement(D.a.Column,{width:8},n.a.createElement(R.c,null,n.a.createElement(R.a,{path:"/admin-panel"},n.a.createElement(ve,null),n.a.createElement($,null)))),n.a.createElement(D.a.Column,{width:4},n.a.createElement(ye,null))))):n.a.createElement(je,null))}var Te=a(354),De=function(e){var t=new Date(e.creationDate),a="".concat(t.getDate(),"/").concat(t.getMonth()+1,"/").concat(t.getFullYear());return n.a.createElement(Te.a,null,n.a.createElement(Te.a.Content,null,n.a.createElement(Te.a.Header,null,e.name),n.a.createElement(Te.a.Meta,null,n.a.createElement("span",{className:"date"},"Created on ",a)),n.a.createElement(Te.a.Description,null,e.description),n.a.createElement("span",null,"Price: ",e.price)))},_e=function(){var e=Object(u.b)(),t=Object(u.c)((function(e){return e.products})),a=Object(r.useState)(!0),c=Object(_.a)(a,2),o=c[0],s=c[1];Object(r.useEffect)((function(){return function(){return e(Y())}}),[]),Object(r.useEffect)((function(){e(x({page:t.page,queryParams:t.queryParams}))}),[t.page]),Object(r.useEffect)((function(){switch(t.currentAction){case v.getProductsRequest:s(!0);break;case v.getProductsSuccess:s(!1)}}),[t.currentAction]);return n.a.createElement(T.a,null,n.a.createElement(D.a,{columns:2},n.a.createElement(D.a.Column,{width:4},n.a.createElement(Pe,null)),n.a.createElement(D.a.Column,{width:12},n.a.createElement(ve,null),n.a.createElement(D.a,{relaxed:!0},o&&n.a.createElement(A.a,{active:!0,inverted:!0},n.a.createElement(k.a,{inverted:!0,content:"Loading products"})),t.items.map((function(e){return n.a.createElement(D.a.Column,{width:4,key:e.id},n.a.createElement(De,e))})),n.a.createElement(D.a.Row,null,n.a.createElement(D.a.Column,null,n.a.createElement(q.a,{defaultActivePage:1,activePage:t.activePage,totalPages:t.pagesNumber,onPageChange:function(t,a){var r=a.activePage;e(H(r))}})))))))},Ae=function(){return n.a.createElement(T.a,null,n.a.createElement(he.a,{as:"h1"},"Catalog"),n.a.createElement(_e,null))},ke=function(){return n.a.createElement(T.a,null,n.a.createElement(Oe,null),n.a.createElement(R.c,null,n.a.createElement(R.a,{exact:!0,path:"/"},n.a.createElement(Ae,null))))},Ue=function(){return n.a.createElement(u.a,{store:w},n.a.createElement(C.a,{basename:"/catalog-spa"},n.a.createElement(R.c,null,n.a.createElement(R.a,{exact:!0,path:"/"},n.a.createElement(ke,null)),n.a.createElement(R.a,{path:"/admin-panel"},n.a.createElement(Re,null)),n.a.createElement(R.a,null,n.a.createElement(je,null)))))},qe=a(27),Ne=function(e,t){var a=t.queryParams,r=e.products.all(),n=function(e){switch(e){case"name":var t=new RegExp(a[e],"gi");r=r.filter((function(e){return!!e.attrs.name.match(t)}));break;case"priceFrom":r=r.filter((function(t){return+t.attrs.price>=+a[e]}));break;case"priceTo":r=r.filter((function(t){return+t.attrs.price<=+a[e]}));break;case"sort":switch(a.sort){case"name-ascend":r=r.sort((function(e,t){return e.attrs.name.localeCompare(t.attrs.name)}));break;case"name-descend":r=r.sort((function(e,t){return t.attrs.name.localeCompare(e.attrs.name)}));break;case"price-ascend":r=r.sort((function(e,t){return e.attrs.price-t.attrs.price}));break;case"price-descend":r=r.sort((function(e,t){return t.attrs.price-e.attrs.price}));break;case"date-ascend":r=r.sort((function(e,t){return e.attrs.creationDate-t.attrs.creationDate}));break;case"date-descend":r=r.sort((function(e,t){return t.attrs.creationDate-e.attrs.creationDate}))}}};for(var c in a)n(c);return r};a(336);!function(){var e={};new qe.d({models:{products:qe.b,users:qe.b},factories:{product:qe.a.extend({name:function(e){return"Product ".concat(e)},description:function(e){return"A product number ".concat(e)},price:function(e){return+"".concat(e,"00")},creationDate:function(){return new Date}}),user:qe.a.extend({name:function(e){return"Name ".concat(e)},surname:function(e){return"Surname ".concat(e)},email:function(e){return"email".concat(e,"@gmail.com")},password:function(e){return"password".concat(e)},type:"C"})},routes:function(){this.namespace="https://thelonerover.github.io/catalog-spa",this.get("/users"),this.get("/users/:id"),this.post("/users",(function(e,t){var a=JSON.parse(t.requestBody);return e.users.findBy({email:a.email})?new qe.c(409,{},{error:"The user already exists!"}):e.users.create(a)})),this.patch("/users/:id"),this.del("/users/:id"),this.post("/login",(function(t,a){var r=JSON.parse(a.requestBody),n=t.users.findBy({email:r.email}),c=Math.round(1e7*Math.random());if(!n)return new qe.c(401,{},{error:"No such user!"});if(n.attrs.email===r.email&&n.attrs.password===r.password){e[c]=Object(l.a)({},n.attrs);var o=new Date,u=new Date(o.getTime()+864e5);return document.cookie="session=".concat(c,"; domain=localhost; path=/; expires=").concat(u.toUTCString(),";"),new qe.c(201,{},{email:n.attrs.email,type:n.attrs.type})}return new qe.c(401,{},{error:"Wrong username or password!"})})),this.get("/products/:id"),this.post("/products",(function(t,a){var r=JSON.parse(a.requestBody);r.creationDate=new Date;var n=+document.cookie.split("=")[1];return"A"===e[n].type?t.products.create(r):new qe.c(403,{},{error:"Forbidden!"})})),this.patch("/products/:id"),this.patch("/products/:id",(function(e,t){var a=JSON.parse(t.requestBody),r=t.params.id;return e.products.find(r).update(a)})),this.del("/products/:id"),this.get("/products",(function(e,t){var a=Ne(e,t),r=Math.ceil(a.length/8);return{products:a.models.slice(8*(r-1),8*r),numberOfPages:r}})),this.get("/products/page/:number",(function(e,t){var a=t.params.number,r=Ne(e,t),n=Math.ceil(r.length/8);return{products:r.models.slice(8*(a-1),8*a),numberOfPages:n}}))},seeds:function(e){e.create("user",{email:"admin@example.com",password:"123",type:"A"});for(var t=0;t<96;t++)e.create("product"),e.create("user")}})}(),o.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(Ue,null)),document.getElementById("root"))}},[[203,1,2]]]);
//# sourceMappingURL=main.de0caca3.chunk.js.map